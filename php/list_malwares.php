<?php
// Chemin vers le répertoire contenant les malwares
$malwareDirectory = '/var/www/html/Downloaded/malware_upload/';

// Ouvrir le répertoire
$dir = new DirectoryIterator($malwareDirectory);

// Début du tableau HTML
$output = "<table class='malwaretable'>";
$output .= "<thead><tr><th>Nom du fichier</th><th>Taille</th><th>Type</th><th>Date de création</th><th>Action</th></tr></thead><tbody>";

// Boucle sur chaque fichier du répertoire
foreach ($dir as $fileinfo) {
    if (!$fileinfo->isDot()) {
        // Obtenez le nom du fichier
        $filename = $fileinfo->getFilename();

        // Obtenez la taille du fichier et convertissez-la en Ko/Mo/Go
        $filesize = $fileinfo->getSize();
        $sizes = array('B', 'KB', 'MB', 'GB', 'TB');
        $factor = floor((strlen($filesize) - 1) / 3);
        $humanFileSize = sprintf("%.2f", $filesize / pow(1024, $factor)) . @$sizes[$factor];
        
        // Obtenez l'extension du fichier
        $fileExtension = $fileinfo->getExtension();

        // Obtenez la date de création du fichier
        $fileCreationDate = date("F d Y H:i:s.", $fileinfo->getMTime());

        // Création d'une ligne de tableau pour chaque fichier
        $output .= "<tr>";
        $output .= "<td>{$filename}</td>";
        $output .= "<td>{$humanFileSize}</td>";
        $output .= "<td>{$fileExtension}</td>";
        $output .= "<td>{$fileCreationDate}</td>";
        $output .= "<td><button class='runMalware' data-filename='{$filename}'>Run</button></td>";
        $output .= "</tr>";
    }
}

// Fin du tableau HTML
$output .= "</tbody></table>";

// Affichage du tableau
echo $output;
?>

